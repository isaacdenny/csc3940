#include <string.h>

// Compile with:  gcc -m32 -z execstack -o test_shellcode test_shellcode.c
// Run with: ./test_shellcode

// Pwned message shellcoe
char shellcode[] = \
    "\xeb\x19\x31\xc0\x31\xdb\x31\xd2\x31\xc9\xb0\x04\xb3\x01\x59\xb2\x16\xcd"
    "\x80\x31\xc0\xb0\x01\x31\xdb\xcd\x80\xe8\xe2\xff\xff\xff\x54\x68\x69\x73"
    "\x20\x69\x73\x20\x73\x6f\x61\x65\x20\x73\x61\x75\x63\x6f\x64\x65\x6d\x6e"
    "\x61\x64\x65\x73\x65\x74\x0a";

int main(int argc, char **argv) {
  char code[500];

  strcpy(code, shellcode);
  int (*func)() = (int (*)())code;

  func();
  return 1;
}
